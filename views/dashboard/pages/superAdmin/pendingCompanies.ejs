<!doctype html>
<html lang="<%= locale %>" dir="<%= dir %>">

<%- include('../../partials/head.ejs') %>

<body class="">
  <div class="bmd-layout-container bmd-drawer-f-l avam-container animated bmd-drawer-in">

    <!-- Header -->
    <%- include('../../partials/header.ejs') %>

    <!-- Sidebar -->
    <div id="dw-s1" class="bmd-layout-drawer bg-faded">
      <%- include('../../partials/sidebar.ejs') %>
    </div>

    <!-- Main Content -->
    <main class="bmd-layout-content">
      <div class="container-fluid my-4">

        <!-- Title + Breadcrumb -->
        <div class="row m-1 pb-4 mb-3">
          <div class="col-12 p-2">
            <div class="page-header breadcrumb-header">
              <div class="row align-items-end">
                <div class="col-lg-8">
                  <div class="page-header-title text-left-rtl">
                    <div class="d-inline">
                      <h3 class="lite-text">
                        <%= t('dashboard:superAdmin.companies.pending_companies_title') %>
                      </h3>
                      <span class="lite-text text-gray">
                        <%= t('dashboard:superAdmin.companies.pending_companies_subtitle') %>
                      </span>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item">
                      <a href="/superadmin/dashboard"><i class="fas fa-home"></i></a>
                    </li>
                    <li class="breadcrumb-item">
                      <a href="/superadmin/companies">
                        <%= t('dashboard:superAdmin.companies.breadcrumb_companies') %>
                      </a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">
                      <%= t('dashboard:superAdmin.companies.pending_companies_title') %>
                    </li>
                  </ol>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Summary Card -->
<div class="row m-1 mb-4">
  <div class="col-md-4 col-sm-6 p-2">
    <div class="card h-100 shadow-sm border-0 text-center p-4" style="transition: transform 0.2s, box-shadow 0.2s; cursor: default;">
      <!-- الرقم -->
      <h2 class="fw-bold mb-2" style="font-size:2.5rem; color:#0d6efd;">
        <%= companies.length %>
      </h2>
      <!-- العنوان -->
      <p class="mb-0 text-secondary fs-5" style="font-weight:500;">
        <%= t('dashboard:superAdmin.companies.pending_companies_count') %>
      </p>
    </div>
  </div>
</div>

<style>
  .card {
    border-radius: 0.75rem;
  }
  .card:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.08);
  }
</style>




        <!-- Companies Table with Search -->
        <div class="row m-1">
          <div class="col-12 p-2">
            <div class="card shade h-100 shadow-sm border-0">
              <div class="card-header d-flex justify-content-between align-items-center ">
                <h5 class="mb-0 d-flex align-items-center gap-2">
                  <i class="bx bx-building-house"></i> <%= t('dashboard:superAdmin.companies.pending_companies_title') %>
                </h5>
                <!-- Search Bar -->
             <div class="position-relative" style="width: 50%;">
  <input 
    id="companySearch" 
    type="text" 
    class="form-control form-control-sm rounded-pill ps-3 pe-3" 
    placeholder="<%= t('dashboard:search_placeholder') %>" 
    style="height:38px; font-size:0.95rem;"
  />
  <span class="position-absolute top-50 start-0 translate-middle-y ps-2 fs-5" style="pointer-events:none;">
    <i class="bx bx-search"></i>
  </span>
</div>

              </div>

              <div class="table-responsive text-nowrap">
                <table class="table table-hover table-striped" id="pendingCompaniesTable">
                  <thead>
                    <tr>
                      <th><i class="bx bx-building-house"></i> <%= t('dashboard:superAdmin.companies.table_company_name') %></th>
                      <th><i class="bx bx-envelope"></i> <%= t('dashboard:superAdmin.companies.table_email') %></th>
                      <th><i class="bx bx-calendar"></i> <%= t('dashboard:superAdmin.companies.table_created_at') %></th>
                      <th class="text-center"><i class="bx bx-cog"></i> <%= t('dashboard:superAdmin.companies.table_actions') %></th>
                    </tr>
                  </thead>
                  <tbody>
                    <% if (companies.length === 0) { %>
                      <tr>
                        <td colspan="4" class="text-center py-5">
                          <div class="text-muted fs-5">
                            <i class="bx bx-time fs-1 d-block mb-2"></i>
                            <%= t('dashboard:superAdmin.companies.empty_state') %>
                          </div>
                        </td>
                      </tr>
                    <% } else { %>
                      <% companies.forEach(company => { %>
                        <tr>
                          <td><i class="bx bx-building-house me-1"></i> <%= company.name %></td>
                          <td><i class="bx bx-envelope me-1"></i> <%= company.email %></td>
                          <td><i class="bx bx-calendar me-1"></i> <%= company.createdAt ? company.createdAt.toLocaleDateString(locale) : '' %></td>
                   <td class="text-center d-flex justify-content-center">
  <a href="/superadmin/companies/<%= company._id %>/view" class="btn btn-primary btn-sm rounded-pill px-4 d-flex align-items-center">
    <i class="bx bx-show me-1"></i> <%= t('dashboard:superAdmin.companies.view') %>
  </a>
</td>

                        </tr>
                      <% }) %>
                    <% } %>
                  </tbody>
                </table>
              </div>

            </div>
          </div>
        </div>

      </div>
    </main>
  </div>

  <%- include('../../partials/scripts.ejs') %>

  <script>
    document.getElementById('companySearch').addEventListener('input', function() {
      const filter = this.value.toLowerCase();
      const rows = document.querySelectorAll('#pendingCompaniesTable tbody tr');
      rows.forEach(row => {
        const name = row.cells[0]?.textContent.toLowerCase() || '';
        const email = row.cells[1]?.textContent.toLowerCase() || '';
        const createdAt = row.cells[2]?.textContent.toLowerCase() || '';
        if (name.includes(filter) || email.includes(filter) || createdAt.includes(filter)) {
          row.style.display = '';
        } else {
          row.style.display = 'none';
        }
      });
    });
  </script>

  <style>
    #companySearch:focus {
      box-shadow: 0 0 10px rgba(0,123,255,0.2);
      outline: none;
    }
    .table th i {
      vertical-align: middle;
      margin-right: 5px;
    }
    .btn-primary {
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }
    .btn-primary:hover {
      background-color: #0b5ed7;
      border-color: #0b5ed7;
    }
  
  </style>

</body>
</html>
